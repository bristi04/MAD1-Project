<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Dashboard</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.rtl.min.css" integrity="sha384-nU14brUcp6StFntEOOEBvcJm4huWjB0OcIeQ3fltAfSmuZFrkAif0T+UtNGlKKQv" crossorigin="anonymous">"
</head>
<style>
  .current{
    background-color:lightgoldenrodyellow;
  }
  .table{
    background-color:lightgoldenrodyellow;
  }
</style>
<body>
    <nav class="navbar navbar-expand-lg bg-body-tertiary" data-bs-theme="dark">
            <div class="container-fluid">
              <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarTogglerDemo03" aria-controls="navbarTogglerDemo03" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
              </button>
              <a class="navbar-brand" href="#">My Dashboard</a>
              <div class="collapse navbar-collapse" id="navbarTogglerDemo03">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                  <li class="nav-item">
                    <a class="nav-link active" aria-current="page" href="/myorders">My Orders</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link active" aria-current="page" href="/bookcart"> View Books</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link active" aria-current="page" href="/profile">Profile</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link active" aria-current="page" href="/login_as_user">Logout</a>
                  </li>
                </ul>
              </div>
            </div>
          </nav><br>
          {% with messages = get_flashed_messages() %}
          {% if messages %}
            {% for message in messages %}
            <div class="alert alert-danger" role="alert">
              {{message}}
            </div>
            {% endfor %}
          {% endif %}
          {% endwith %} <br>
         <div class="current"><br>
            <h2 style="text-align :center">My Requests</h2><br>
            <table class="table">
                <thead>
                  <tr>
                    <th scope="col">Book I'D</th>
                    <th scope="col">Book Title</th>
                    <th scope="col">Author</th>
                    <th scope="col">Price</th>
                    <th scope="col">Status</th>
                    <th scope="col">Date of Issue</th>
                    <th scope="col">Date of Return</th>
                    <th scope="col">Action</th>
                    
                  </tr>
                </thead>
                <tbody>
                  {% for request in myreq %}
                   {% if request.status == 'requested' %}
                   <tr>
                    <td>{{request.book_id}}</td>
                    <td>{{request.book_name}}</td>
                    <td>{{request.author_name}}</td>
                    <td>{{request.price}}</td>
                    <td>{{request.status}}</td>
                    <td>{{request.date_of_issue}}</td>
                    <td>{{request.date_of_return}}</td>
                    <td><a href="/cancel_request/{{request.request_id}}"  class="btn btn-danger" role="button">Cancel Request</a>
                     </td>
                    </tr>
                   {% endif %}
                  {% endfor %}
                </tbody>
              </table><br>
              <div class="current">
                <h2 style="text-align :center">Current Books</h2><br>
                <table class="table">
                    <thead>
                      <tr>
                        <th scope="col">Book I'D</th>
                        <th scope="col">Book Title</th>
                        <th scope="col">Author</th>
                        <th scope="col">Price</th>
                        <th scope="col">Status</th>
                        <th scope="col">Date of Issue</th>
                        <th scope="col">Date of Return</th>
                        <th scope="col">Books</th>
                        <th scope="col">Action</th>

                        
                      </tr>
                    </thead>
                    <tbody>
                      {% for request in myreq %}
                       {% if request.status == 'granted' %}
                       <tr>
                        <td>{{request.book_id}}</td>
                        <td>{{request.book_name}}</td>
                        <td>{{request.author_name}}</td>
                        <td>{{request.price}}</td>
                        <td>{{request.status}}</td>
                        <td>{{request.date_of_issue}}</td>
                        <td>{{request.date_of_return}}</td>
                        <td><a href="/access_ebook/{{request.request_id}}" class="btn btn-info" role="button">Access e-book</a>
                        </td>
                        <td><a href="/return/{{request.request_id}}"  class="btn btn-danger" role="button">Return</a>
                         </td>
                         <td>
                        </tr>
                       {% endif %}
                      {% endfor %}
                    </tbody>
                  </table><br>
                  <div class="current">
                    <h2 style="text-align :center">Rejected</h2><br>
                    <table class="table">
                        <thead>
                          <tr>
                            <th scope="col">Book I'D</th>
                            <th scope="col">Book Title</th>
                            <th scope="col">Author</th>
                            <th scope="col">Price</th>
                            <th scope="col">Status</th>
                            
                          </tr>
                        </thead>
                        <tbody>
                          {% for request in myreq %}
                           {% if request.status == 'request rejected' %}
                           <tr>
                            <td>{{request.book_id}}</td>
                            <td>{{request.book_name}}</td>
                            <td>{{request.author_name}}</td>
                            <td>{{request.price}}</td>
                            <td>{{request.status}}</td>
                            <td>Sorry! Your request has been rejected, please try again later.</td>
                            </tr>
                           {% endif %}
                          {% endfor %}
                        </tbody>
                      </table><br>
</body>
</html>
                     
                        
                     
                    
              